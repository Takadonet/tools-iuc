<tool id="vsearch" name="VSearch" version="@VERSION@.0">
    <description></description>
    <expand macro="requirements" />
    <expand macro="stdio" />
    <expand macro="version_command" />
    <macros>
        <import>vsearch_macros.xml</import>
    </macros>
    <command>
<![CDATA[
    vsearch
        @GENERAL@
        --cluster_fast "$infile"
        ##--cluster_smallmem FILENAME  cluster sequences using a small amount of memory
        ##--clusters STRING            output each cluster to a separate FASTA file

        --cons_truncate $cons_truncate
        --id $id
        --iddef $iddef

        #if '--msaout' in $outputs:
            --msaout $msaout
        #end if
        #if '--consout' in $outputs:
            --consout $consout
        #end if
        #if '--centroids' in $outputs:
            --centroids $centroids
        #end if
        #if '-uc' in $outputs:
            --uc $uc
        #end if
        #if $qmask != 'no':
            --qmask $qmask
        #end if
        --sizein $sizein
        --sizeout $sizeout
        --strand $strand
        --usersort $usersort

]]>
    </command>
    <inputs>
        <param name="infile" type="data" format="fasta" label="Select your FASTA file" help="(--cluster_fast)" />
        <param name="iddef" type="select" label="ID definition" help="(--iddef)">
            <option value="0">CD-HIT</option>
            <option value="1">all</option>
            <option value="2" selected="True">int</option>
            <option value="3">MBL</option>
            <option value="4">BLAST</option>
        </param>
        <param name="id" type="integer" value="" label="Treshold"
            help="Reject if identity lower. (--id)"/>

        <param name="cons_truncate" type="boolean" truevalue="--cons_truncate" falsevalue="" checked="False" 
            label="Do not ignore terminal gaps in MSA for consensus" help="(--cons_truncate)"/>
        <param name="usersort" type="boolean" truevalue="--usersort" falsevalue="" checked="False" 
            label="Indicate that input sequences are presorted" help="(--usersort)"/>
        <param name="qmask" type="select" label="Mask seqs with dust" help="(--qmask)">
            <option value="no">No masking</option>
            <option value="dust" selected="True">dust</option>
            <option value="soft">soft</option>
        </param>
        <param name="sizein" type="boolean" truevalue="--sizein" falsevalue="" checked="False" 
            label="Read abundance annotation from input" help="(--sizein)"/>
        <param name="sizeout" type="boolean" truevalue="--sizeout" falsevalue="" checked="False" 
            label="Write cluster abundances to centroid file" help="(--sizeout)"/>
        <param name="strand" type="select" label="Strand specific clustering" help="(--strand)">
            <option value="plus" selected="True">Plus strand</option>
            <option value="both">Both strands</option>
        </param>
        <param name="outputs" type="select" label="Select output files" help="">
            <option value="--msaout">Multiple sequence alignments</option>
            <option value="--consout">Cluster consensus sequences</option>
            <option value="--centroids">Centroid sequences</option>
            <option value="--uc">UCLUST-like</option>
            <validator type="no_options" message="Please select at least one output."/>
        </param>

    </inputs>
    <outputs>
        <data name="msaout" format="fasta" label="${tool.name} on ${on_string}: Multiple Sequence Alignments">
            <filter>'--msaout' in outputs</filter>
        </data>
        <data name="consout" format="fasta" label="${tool.name} on ${on_string}: Consensus Sequences">
            <filter>'--consout' in outputs</filter>
        </data>
        <data name="centroids" format="fasta" label="${tool.name} on ${on_string}: Cluster centroids">
            <filter>'--centroids' in outputs</filter>
        </data>
        <data name="uc" format="fasta" label="${tool.name} on ${on_string}: UCLUST like output">
            <filter>'--uc' in outputs</filter>
        </data>
    </outputs>
    <tests>
    </tests>
    <help>
<![CDATA[
**What it does**

General options
  --help                      display help information
  --version                   display version information
  --fasta_width INT           width of FASTA seq lines, 0 for no wrap (80)
  --maxseqlength INT          maximum sequence length (50000)
  --minseqlength INT          min seq length (clust/derep/search: 32, other:1)
  --notrunclabels             do not truncate labels at first space
  --threads INT               number of threads to use, zero for all cores (0)

Clustering options (most searching options also apply)
  --centroids FILENAME         output centroid sequences to FASTA file
  --cluster_fast FILENAME      cluster sequences fast
  --cluster_smallmem FILENAME  cluster sequences using a small amount of memory
  --clusters STRING            output each cluster to a separate FASTA file
  --consout FILENAME           output cluster consensus sequences to FASTA file
  --cons_truncate              do not ignore terminal gaps in MSA for consensus
  --id REAL                    reject if identity lower
  --iddef INT                  id definition, 0-4=CD-HIT,all,int,MBL,BLAST (2)
  --msaout FILENAME            output multiple seq. alignments to FASTA file 
  --qmask                      mask seqs with dust, soft or no method (dust)
  --sizein                     read abundance annotation from input
  --sizeout                    write cluster abundances to centroid file
  --strand                     cluster using "plus" or "both" strands (plus)
  --uc FILENAME                filename for UCLUST-like output
  --usersort                   indicate that input sequences are presorted


@EXTERNAL_DOCUMENTATION@

-------

@REFERENCES@


]]>
    </help>
</tool>
