<tool id="vsearch" name="VSearch" version="@VERSION@.0">
    <description></description>
    <expand macro="requirements" />
    <expand macro="stdio" />
    <expand macro="version_command" />
    <macros>
        <import>vsearch_macros.xml</import>
    </macros>
    <command>
<![CDATA[
    vsearch
        @GENERAL@
        #if sorting_mode.sorting_mode_select == 'sortbylength':
            --sortbylength "$sorting_mode.infile"
        #else:
            --sortbysize FILENAME "$sorting_mode.infile"
            --maxsize $sorting_mode.maxsize
            --minsize $sorting_mode.minsize
        #end if
        --output $outfile
        --sizeout $sizeout
        --topn $topn

]]>
    </command>
    <inputs>
        <conditional name="sorting_mode">
            <param name="sorting_mode_select" type="select" label="Sorting by" help="">
                <option value="sortbylength">sequence length</option>
                <option value="sortbyabundance">by abundance</option>
            </param>
            <when value="sortbylength">
                <param name="infile" type="data" format="fasta" label="Select your FASTA file" help="(--sortbylength)" />
            </when>
            <when value="sortbyabundance">
                <param name="infile" type="data" format="fasta" label="Select your FASTA file" help="(--sortbysize)" />
                <param name="minsize" type="integer" value="" label="Minimum abundance"
                    help="(--minsize)"/>
                <param name="maxsize" type="integer" value="" label="Maximum abundance"
                    help="(--maxsize)"/>
          </when>
        </conditional>
        <expand macro="topn" />
        <param name="sizeout" type="boolean" truevalue="--sizeout" falsevalue="" checked="False" 
            label="Add abundance annotation to output" help="(--sizeout)"/>
    </inputs>
    <outputs>
        <data name="outfile" format="fasta" label="${tool.name} on ${on_string}" />
    </outputs>
    <tests>
    </tests>
    <help>
<![CDATA[
**What it does**

General options
  --help                      display help information
  --version                   display version information
  --fasta_width INT           width of FASTA seq lines, 0 for no wrap (80)
  --maxseqlength INT          maximum sequence length (50000)
  --minseqlength INT          min seq length (clust/derep/search: 32, other:1)
  --notrunclabels             do not truncate labels at first space
  --threads INT               number of threads to use, zero for all cores (0)

Sorting options
  --maxsize INT               maximum abundance for sortbysize
  --minsize INT               minimum abundance for sortbysize
  --output FILENAME           output FASTA file
  --relabel STRING            relabel with this prefix string after sorting
  --sizeout                   add abundance annotation to output
  --sortbylength FILENAME     sort sequences by length in given FASTA file
  --sortbysize FILENAME       abundance sort sequences in given FASTA file
  --topn INT                  output just top n seqs after sorting


@EXTERNAL_DOCUMENTATION@

-------

@REFERENCES@


]]>
    </help>
</tool>
